<form [formGroup]="form" (ngSubmit)="onSubmit()" class="container">

  <section class="section" *ngIf="currentStep === 1  && !isLoading && !isSuccess && !isServerError">
    <header class="section__header">
      <mat-icon routerLink="/dashboard" class="section__icon">close</mat-icon>
      <h1 class="section__title">Qual é o <strong>nome</strong> do equipamento cadastrado?</h1>
    </header>

    <div>
      <label class="section__label">
        Insira o nome

        <input type="text" formControlName="nome" placeholder="Insira o nome" enterkeyhint="next"
          (keydown.enter)="$event.preventDefault(); nextStep()" class="section__input">
      </label>
    </div>

    <footer class="section__footer">
      <button type="button" (click)="nextStep()" [disabled]="!form.get('nome')?.valid"
        class="section__button">Continuar</button>
    </footer>
  </section>

  <section class="section" *ngIf="currentStep === 2 && !isLoading && !isSuccess && !isServerError">
    <header class="section__header">
      <mat-icon class="section__icon" (click)="prevStep()">arrow_back_ios_new</mat-icon>
      <h1 class="section__title">Anexe a foto da sua prancheta</h1>
    </header>

    <div>
      <label class="section__label section__label--file">
        <mat-icon class="section__icon section__icon--file">
          cloud_upload
        </mat-icon>

        <span class="section__span">
          {{ selectedFile ? selectedFile.name : 'Clique aqui para anexar a imagem' }}
        </span>

        <input type="file" accept="image/*" (change)="onFileSelected($event)" class="section__input--file">
      </label>
    </div>

    <footer class="section__footer">
      <button type="submit" [disabled]="!selectedFile" class="section__button">Enviar</button>
    </footer>
  </section>

  <section class="section" *ngIf="isLoading && !isSuccess && !isServerError">
    <div class="loading">
      <div class="loading__dot"></div>
      <div class="loading__dot"></div>
      <div class="loading__dot"></div>
    </div>
  </section>

  <section class="section" *ngIf="isSuccess && !isLoading && !isServerError">
    <header class="section__header">
      <mat-icon routerLink="/dashboard" class="section__icon">close</mat-icon>
    </header>

    <div class="section__content section__content--status">
      <img [src]="qrCode" class="section__image" #qrCodeImage>
      <h3 class="section__title">Show de Bola!</h3>
      <p class="section__subtitle">
        Cadastro concluído com sucesso. Agora finalize o processo imprimindo o QR Code e fixando-o no equipamento,
        garantindo que ele seja facilmente reconhecido e acompanhado em todo o seu uso.
      </p>
    </div>

    <footer class="section__footer section__footer--actions">
      <button type="button" (click)="downloadQRCode()" class="section__button section__button--secondary">
        <mat-icon class="section__button-icon">download</mat-icon>
        Baixar QR Code
      </button>
      <button type="button" (click)="shareQRCode()" class="section__button section__button--secondary">
        <mat-icon class="section__button-icon">share</mat-icon>
        Compartilhar
      </button>
    </footer>
  </section>

  <section class="section" *ngIf="isServerError && !isLoading && !isSuccess">
    <header class="section__header">
      <mat-icon routerLink="/dashboard" class="section__icon">close</mat-icon>
    </header>

    <div class="section__content section__content--status">
      <img [src]="serverErrorIllustration" class="section__image">
      <h3 class="section__title">Não pode ser...!</h3>
      <p class="section__subtitle">
        Parece que nosso servidor não está funcionando como deveria. Por favor, tente outra hora!
      </p>
    </div>

    <footer class="section__footer">
      <button type="button" routerLink="/dashboard" class="section__button">Sair</button>
    </footer>
  </section>

</form>
